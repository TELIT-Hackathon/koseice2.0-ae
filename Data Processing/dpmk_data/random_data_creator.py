import mysql.connector
import random
from datetime import datetime, timedelta

mydb = mysql.connector.connect(
host='31.214.247.108',
user='u389_pUG1Sf8i75',
password='vTF7k3qNVmWtxX2tj+XwVZ=x',
database='s389_hackathon'
)
sql = 'insert into traffic_records(time, stop_id, line_id, destination_id) values(%s, %s, %s, %s)'

min_year=2022
max_year=datetime.now().year

start = datetime(min_year, 1, 1, 00, 00, 00)
years = max_year - min_year+1
end = start + timedelta(days=365 * years)

smer_dict = {'0400011': '127', '0400010': '192', '0400021': '229', '0400020': '192', '0400031': '127', '0400030': '229', 
'0400041': '170', '0400061': '229', '0400060': '192', '0406121': '215', '0406120': '229', '0406221': '215', '0406220': '127', 
'0406321': '215', '0406320': '192', '0406421': '215', '0406420': '11', '0406501': '215', '0406500': '47', '0406621': '215', 
'0406721': '215', '0406720': '3', '0406801': '215', '0406800': '170', '0400070': '11', '0400091': '127', '0400090': '109', 
'0400101': '125', '0400100': '85', '0401011': '85', '0401010': '229', '0401021': '224', '0401020': '229', '0401031': '117', 
'0401030': '229', '0401041': '47', '0401040': '229', '0401051': '83', '0401050': '229', '0401061': '59', '0401060': '229', 
'0401071': '127', '0401070': '229', '0400121': '234', '0400120': '224', '0400141': '226', '0400140': '53', '0400151': '245', 
'0400150': '32', '0400161': '245', '0400160': '224', '0400171': '83', '0400170': '101', '0400181': '151', '0400180': '85', 
'0400191': '50', '0400190': '59', '0400211': '140', '0400210': '229', '0400221': '8', '0400220': '22', '0400231': '82', 
'0400230': '229', '0400241': '182', '0400240': '229', '0400261': '215', '0400260': '117', '0400271': '229', '0400270': '85', 
'0400311': '113', '0400310': '67', '0400321': '89', '0400320': '110', '0400331': '229', '0400330': '73', '0400341': '59', 
'0400340': '264', '0400351': '113', '0400350': '83', '0400361': '52', '0400360': '85', '0400511': '113', '0400510': '94', 
'0400521': '117', '0400520': '78', '0400541': '59', '0400540': '85', '0400551': '52', '0400550': '83', '0400561': '117', 
'0400560': '85', '0400711': '59', '0400710': '83', '0400721': '36', '0400720': '83', '0004011': '215', '0004010': '134', 
'0004021': '215', '0004020': '89', '0004031': '215', '0004030': '186', '0004041': '215', '0004040': '186', '0004051': '215', 
'0004050': '218', '0004061': '215', '0004060': '57', '0004071': '215', '0004081': '215', '0400111': '171', '0400110': '113', 
'0400201': '135', '0400200': '110', '0400251': '136', '0400250': '65', '0401261': '136', '0401260': '117', '0400291': '229', 
'0400290': '225', '0400281': '266', '0400280': '50', '0400301': '47', '0400300': '157'}

stops_dict = {
'040001': ['192', '72', '153', '265', '109', '185', '42', '71', '27', '113', '5', '184', '47', '247', '15', '167', '214', '121', '25', '68', '164', '127'], 
'040002': ['192', '72', '153', '265', '109', '185', '42', '71', '27', '113', '169', '229'], 
'040003': ['229', '169', '113', '5', '184', '47', '247', '15', '167', '214', '121', '25', '68', '164', '127'], 
'040004': ['11', '197', '222', '185', '42', '71', '27', '113', '5', '184', '47', '247', '15', '167', '214', '213', '170'], 
'040006': ['192', '72', '153', '265', '109', '185', '3', '151', '58', '92', '130', '183', '267', '180', '144', '276', '71', '27', '113', '169', '229'], 
'040612': ['229', '169', '113', '27', '71', '276', '144', '180', '268', '124', '125', '148', '162', '84', '205', '215'], 
'040622': ['127', '164', '68', '25', '121', '214', '7', '111', '120', '216', '269', '268', '124', '125', '148', '162', '84', '205', '215'], 
'040632': ['192', '72', '153', '265', '109', '185', '3', '151', '58', '92', '130', '183', '267', '268', '124', '125', '148', '162', '84', '205', '215'], 
'040642': ['11', '197', '222', '3', '151', '58', '92', '130', '183', '267', '268', '124', '125', '148', '162', '84', '205', '215'], 
'040650': ['47', '184', '5', '113', '27', '71', '276', '144', '180', '268', '124', '125', '148', '162', '84', '205', '215'], 
'040662': ['29', '183', '267', '268', '124', '125', '148', '162', '84', '205', '215'], 
'040672': ['3', '151', '58', '92', '130', '183', '267', '268', '124', '125', '148', '162', '84', '205', '215'], 
'040680': ['170', '213', '214', '7', '111', '120', '216', '269', '268', '124', '125', '148', '162', '84', '205', '215'], 
'040007': ['11', '197', '222', '185', '42', '71', '27', '113', '5', '184', '47', '247', '15', '167', '214', '213', '170'], 
'040009': ['109', '185', '3', '151', '58', '92', '130', '183', '267', '269', '216', '120', '111', '7', '214', '121', '25', '68', '164', '127'], 
'040010': ['85', '112', '94', '10', '040', '9', '177', '145', '208', '200', '17', '138', '229', '113', '27', '71', '180', '183', '29', '188', '101', '125'], 
'040101': ['229', '55', '113', '169', '138', '17', '200', '208', '145', '177', '9', '040', '10', '94', '112', '85'], 
'040102': ['229', '55', '169', '113', '27', '203', '174', '42', '252', '116', '151', '3', '197', '11', '72', '129', '209', '149', '31', '224'], 
'040103': ['229', '55', '169', '113', '27', '71', '276', '144', '180', '183', '29', '124', '125', '148', '98', '135', '162', '16', '99', '136', '84', '205', '215', '181', '114', '79', '117'], 
'040104': ['229', '169', '55', '113', '27', '71', '276', '144', '180', '183', '29', '188', '101', '158', '231', '184', '47'], 
'040105': ['229', '113', '55', '210', '103', '115', '128', '129', '157', '43', '57', '34', '150', '126', '123', '95', '83'], 
'040106': ['229', '55', '169', '113', '27', '71', '166', '92', '45', '24', '105', '152', '96', '49', '59'], 
'040107': ['229', '169', '55', '113', '138', '17', '137', '37', '206', '12', '194', '198', '122', '121', '25', '68', '164', '127'],
'040012': ['224', '20', '6', '31', '149', '209', '129', '72', '11', '197', '3', '151', '116', '252', '42', '174', '203', '27', '172', '139', '184', '202', '154', '15', '214', '77', '199', '220', '69', '41', '147', '234'], 
'040014': ['53', '54', '248', '1', '46', '26', '21', '190', '81', '192', '72', '11', '197', '222', '185', '109', '103', '115', '128', '129', '209', '87', '4', '51', '226'], 
'040015': ['32', '150', '126', '123', '95', '168', '17', '138', '229', '113', '27', '172', '139', '184', '231', '158', '280', '245'], 
'040016': ['224', '31', '149', '209', '129', '128', '115', '103', '210', '229', '55', '169', '113', '27', '172', '139', '184', '231', '158', '280', '245'], 
'040017': ['101', '188', '29', '100', '201', '19', '232', '45', '48', '178', '151', '116', '252', '42', '174', '185', '109', '228', '155', '229', '55', '169', '138', '17', '200', '208', '145', '57', '34', '150', '126', '123', '95', '83'],
'040018': ['85', '112', '94', '10', '040', '9', '177', '43', '157', '129', '72', '11', '119', '3', '151'], 
'040019': ['59', '56', '60', '52', '152', '96', '186', '178', '151', '3', '119', '11', '197', '222', '185', '109', '228', '155', '229', '55', '169', '138', '17', '137', '37', '206', '12', '194', '198', '122', '121', '25', '50'], 
'040021': ['229', '55', '169', '113', '27', '71', '180', '124', '125', '211', '148', '162', '84', '205', '33', '212', '251', '311', '310', '306', '146', '143', '187', '18', '140'], 
'040022': ['22', '142', '43', '157', '129', '128', '115', '103', '109', '185', '222', '197', '3', '173', '75', '8'], 
'040023': ['229', '55', '169', '113', '27', '71', '180', '124', '125', '211', '148', '272', '271', '253', '82'], 
'040024': ['229', '55', '113', '169', '165', '88', '47', '214', '213', '170', '41', '147', '227', '238', '239', '237', '236', '270', '182'], 
'040026': ['117', '79', '114', '181', '215'], 
'040027': ['85', '112', '94', '10', '040', '9', '177', '43', '157', '129', '128', '115', '103', '210', '55', '229'], 
'040031': ['67', '204', '28', '12', '206', '37', '137', '17', '138', '113'], 
'040032': ['110', '14', '90', '23', '76', '83', '95', '261', '168', '17', '138', '113', '27', '71', '180', '183', '29', '188', '101', '160', '61', '108', '66', '36', '219', '89'], 
'040033': ['73', '221', '104', '145', '208', '200', '17', '138', '169', '55', '229'], 
'040034': ['264', '125', '158', '216', '183', '29', '188', '101', '160', '74', '30', '246', '152', '96', '49', '59'], 
'040035': ['83', '95', '277', '273', '261', '168', '17', '138', '113'], 
'040036': ['85', '112', '94', '10', '040', '9', '177', '43', '157', '129', '128', '115', '103', '109', '185', '174', '42', '252', '116', '151', '178', '186', '96', '152', '52'], 
'040051': ['94', '10', '040', '9', '177', '145', '200', '138', '113'], 
'040052': ['78', '275', '80', '106', '35', '127', '164', '68', '25', '121', '122', '198', '194', '12', '206', '37', '137', '17', '138', '113', '27', '71', '180', '124', '125', '211', '148', '162', '84', '205', '181', '114', '79', '117'], 
'040054': ['85', '112', '94', '10', '040', '9', '177', '57', '34', '150', '126', '95', '37', '12', '198', '122', '25', '121', '214', '15', '154', '202', '184', '231', '216', '183', '29', '188', '101', '160', '74', '30', '246', '152', '96', '49', '59'],
'040055': ['83', '95', '123', '126', '150', '34', '57', '43', '157', '129', '72', '11', '119', '3', '151', '178', '186', '96', '152', '52'], 
'040056': ['85', '112', '94', '65', '145', '200', '138', '113', '27', '71', '180', '124', '125', '148', '205', '181', '114', '79', '117'], 
'040071': ['83', '95', '123', '126', '150', '34', '57', '43', '157', '129', '128', '115', '103', '210', '55', '169', '113', '27', '71', '166', '92', '45', '24', '105', '152', '96', '49', '59'], 
'040072': ['83', '95', '123', '126', '150', '34', '57', '43', '157', '129', '128', '115', '103', '210', '55', '169', '113', '27', '71', '166', '92', '45', '24', '105', '52', '36'], 
'000401': ['134', '38', '97', '148', '135', '98', '136', '99', '16', '84', '205', '215'], 
'000402': ['89', '219', '36', '66', '108', '61', '160', '134', '38', '97', '148', '135', '98', '136', '99', '16', '84', '205', '215'], 
'000403': ['186', '49', '59', '56', '60', '52', '246', '105', '30', '74', '160', '148', '205', '215'], 
'000404': ['186', '96', '152', '246', '30', '74', '160', '148', '205', '215'], 
'000405': ['218', '64', '85', '112', '94', '10', '040', '9', '177', '145', '37', '198', '148', '205', '215'], 
'000406': ['57', '34', '150', '126', '123', '95', '83', '168', '37', '198', '148', '205', '215'], 
'000407': ['110', '14', '23', '76', '83', '95', '168', '37', '198', '148', '205', '215'],
'000408': ['218', '64', '85', '112', '94', '65', '145', '37', '198', '148', '205', '215'], 
'040011': ['113', '27', '71', '180', '124', '160', '171'], 
'040020': ['110', '14', '90', '23', '76', '83', '95', '261', '168', '17', '138', '113', '27', '71', '412', '201', '232', '100', '183', '180', '124', '125', '211', '148', '97', '38', '134', '98', '135'], 
'040025': ['65', '94', '112', '85', '64', '218', '86', '176', '262', '43', '157', '129', '128', '115', '103', '210', '55', '169', '113', '27', '71', '180', '124', '125', '211', '148', '162', '16', '99', '136'], 
'040126': ['117', '79', '114', '181', '205', '84', '411', '162', '16', '99', '136'], 
'040029': ['225', '93', '63', '13', '240', '207', '217', '189', '196', '91', '20', '224', '31', '149', '6', '209', '129', '128', '115', '103', '210', '55', '229'], 
'040028': ['50', '68', '164', '127', '35', '106', '80', '275', '274', '107', '257', '254', '255', '256', '266'], 
'040030': ['157', '175', '141', '191', '115', '228', '155', '229', '55', '169', '113', '165', '88', '47']}



def get_stops(line_id):
    mycursor = mydb.cursor()
    sql = 'SELECT stops FROM connections WHERE id=' + str(line_id)
    mycursor.execute(sql)
    stops = None
    for stop in mycursor:
        stops = stop[0].split(',')
    mycursor.close()
    return stops

val = []

for y in range(1, 2000001):
    number_of_people = random.randint(1,10)

    random_key = random.choice(list(smer_dict.keys()))
    random_date = start + (end - start) * random.random()
    random_line_id = random_key[:-1]
    random_destination = smer_dict[random_key]
    stops_list = stops_dict[random_line_id]
    try:
        stops_list.remove(random_destination)
    except:
        pass
    random_stop_id = random.choice(stops_list)

    for i in range(number_of_people):
        val.append((random_date, int(random_stop_id), int(random_line_id), int(random_destination)))

    if y // 1000 == y / 1000:
        mycursor = mydb.cursor()
        mycursor.executemany(sql, val)
        mydb.commit()
        print(mycursor.rowcount, 'updated', y)
        val = []
#done

